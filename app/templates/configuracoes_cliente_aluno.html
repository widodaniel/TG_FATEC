<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Perfil</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous" />
  <link rel="stylesheet" type="text/css"
    href="{{ url_for('static', filename='css/style320_configuracoes_cliente.css') }}">
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/home_enade.css') }}">
</head>

<body>
  <header>
    <nav>
      <a class="logo" href="/">SIMENADS</a>
      <div class="mobile-menu">
        <div class="line1"></div>
        <div class="line2"></div>
        <div class="line3"></div>
      </div>
      <ul class="nav-list">
        <li><a class="nav-button-home" href="{{ url_for('index') }}">Home</a></li>
        <li><a class="nav-button-home" href="{{ url_for('logout') }}">Sair</a></li>
      </ul>
    </nav>
  </header>
  <main>
    <section class="sectionBotoesSecao">
      <div id="divBotoesSecao">
        <h3>Seja bem-vindo, <b>{{ current_user.nome }}!</b></h3>
        <div class="divBotoes">
          <a href="{{ url_for('relatorios_aluno')}}"><button class="btnDivSecao">Relatórios</button></a>
        </div>
      </div>
    </section>
    <section class="sectionDadosPessoas">
      <div id="accordion">
        <!-- Seção Informações Pessoais -->
        <div class="card div-card">
          <div class="card-header div-btn-collapes" id="headingInformacoes">
            <h2 class="mb-0">
              <button class="btn btn-collapes" type="button" data-toggle="collapse" data-target="#collapseInformacoes"
                aria-expanded="true" aria-controls="collapseInformacoes">
                Informações Pessoais
              </button>
            </h2>
          </div>

          <div id="collapseInformacoes" class="collapse div-collapes-info" aria-labelledby="headingInformacoes"
            data-parent="#accordion">
            <div class="card-body">
              <form method="POST" action="{{ url_for('atualizar_dados') }}">
                <div class="div-form-padrao form-group">
                  <label for="lbl_dadosPessoasNome" class="label-padrao">Nome</label>
                  <input type="text" class="input-padrao form-control" id="input_dadosPessoasNome"
                    aria-describedby="Nome" placeholder="Nome" value="{{ current_user.nome.title() }}"
                    name="input_dadosPessoasNome">
                </div>
                <div class="div-form-padrao form-group">
                  <label for="lbl_dadosPessoasCpf" class="label-padrao">CPF</label>
                  <input type="text" class="input-padrao form-control" id="input_dadosPessoasCpf" placeholder="CPF"
                    value="{{ current_user.cpf }}" disabled>
                </div>
                <div class="div-form-padrao form-group">
                  <label for="lbl_dadosPessoasEmail" class="label-padrao">E-mail</label>
                  <input type="email" class="input-padrao form-control" id="input_dadosPessoasEmail"
                    placeholder="E-mail" value="{{ current_user.email }}" name="input_dadosPessoasEmail">
                </div>
                <div class="d-flex justify-content-center">
                  <button type="submit" class="btn-padrao btn btn-primary">Alterar informações</button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <!-- Seção Senha -->
        <div class="card div-card">
          <div class="card-header div-btn-collapes" id="headingSenha">
            <h2 class="mb-0">
              <button class="btn btn-collapes" type="button" data-toggle="collapse" data-target="#collapseSenha"
                aria-expanded="false" aria-controls="collapseSenha">
                Senha
              </button>
            </h2>
          </div>
          <div id="collapseSenha" class="collapse" aria-labelledby="headingSenha" data-parent="#accordion">
            <form method="POST" action="{{ url_for('atualizar_senha') }}">
              <div id="divSenha">
                <div class="div-form-padrao form-group">
                  <label for="lbl_senha" class="label-padrao">Senha atual</label>
                  <input type="password" class="input-padrao form-control" id="input_dadosPessoasSenhaAntiga" aria-describedby="Senha Atual"
                    placeholder="Senha antiga" name="senhaAntiga">
                </div>
                <div class="div-form-padrao form-group">
                  <label for="lbl_senha" class="label-padrao">Nova senha</label>
                  <input type="password" class="input-padrao form-control" id="input_dadosPessoasSenhaNova" aria-describedby="Senha Nova"
                    placeholder="Senha nova" name="senhaNova">
                </div>
                <div class="d-flex justify-content-center">
                  <button type="submit" class="btn-padrao btn btn-primary ">Alterar senha</button>
                </div>
                </div>
              </form>
          </div>
        </div>
      </div>
    </section>
  </main>
  <footer class="text-center text-white">
    <div class="footer-row row">
      <div class="container-footer">
        <div class="info-footer mb-3 mb-md-0">
          Estas informações foram obtidas através das provas do ENADE divulgadas no site do Inep mais informações
          consultar: <a href="https://www.gov.br/inep/pt-br/areas-de-atuacao/avaliacao-e-exames-educacionais/enade"
            target="blank">SITE do INEP</a>
        </div>
      </div>
      <p class="endereco-footer mt-4 mb-3">
        <a href="http://www.fateccarapicuiba.edu.br/" target="blank">FATEC CARAPICUIBA | </a> <a
          href="http://www.fateccarapicuiba.edu.br/analise-e-desenvolvimento-de-sistemas/" target="blank">Tecnologia
          Análise e Desenvolvimento Sistemas</a>
      </p>
    </div>
    <!-- Copyright -->
    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2)">
      © 2024 Copyright: SIMENADS
      <a class="text-white" href="https://mdbootstrap.com/"></a>
    </div>
    <!-- Copyright -->
  </footer>
  <!-- Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script>
    $(document).ready(function () {
    $("form").submit(function (event) {
        event.preventDefault();
        var form = $(this);
        fetch(form.attr("action"), {
            method: form.attr("method"),
            body: new FormData(form[0]),
        })
        .then((response) => response.json())
        .then((data) => {
            if (data.success) {
                Swal.fire({
                    icon: "success",
                    title: data.messageTitle || "Dados alterados com sucesso!",
                    text: data.messageText,
                    showConfirmButton: true,
                }).then(function () {
                    window.location.reload(); // Recarrega a página após a confirmação
                });
            } else {
                Swal.fire({
                    icon: "error",
                    title: data.messageTitle || "Falha ao alterar os dados!",
                    text: data.messageText,
                    showConfirmButton: true,
                }).then(function () {
                  window.location.reload(); // Recarrega a página após a confirmação
                });
            }
        })
        .catch((error) => {
            console.error("Erro na requisição:", error);
        });
    });
  });
  </script>
</body>

</html>